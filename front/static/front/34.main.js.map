{"version":3,"file":"34.main.js","sources":["webpack:///./src/components/views/safety/Video.js"],"sourcesContent":["import React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport { Redirect } from 'react-router-dom'\nimport { getProfileFetch } from '../../../actions'\nimport {\n  CRow,\n  CCol,\n  CEmbed,\n  CButton,\n  CCard,\n  CCardBody,\n  CCardTitle,\n  CCardHeader\n} from \"@coreui/react\";\nimport { FoxApiService } from '../../../services';\n\nconst foxApi = new FoxApiService();\n\n\nclass SafetyVideo extends Component {\n\n  state = {\n    name: \"\",\n    file: \"\",\n    personal_declaration_template: \"\",\n    safety_quiz_template: \"\",\n    safety_video_url: \"\",\n  }\n\n  downloadFile = async (e) => {\n    this.setState({\n      filename: e.target.value,\n      doc_type: e.target.name\n    }\n      , () => {\n        foxApi.downloadSafetyTemplate(this.state.doc_type)\n          .then((blob) => {\n            const url = window.URL.createObjectURL(new Blob([blob]));\n            const link = document.createElement('a');\n            link.href = url;\n            const filename = this.state.filename.split('/').pop();\n            link.setAttribute('download', filename);\n            document.body.appendChild(link);\n            link.click();\n            link.parentNode.removeChild(link);\n          })\n          .then(() => { console.log('file downloaded') })\n          .catch((error) => {\n            console.error('File download failed!');\n            console.error(error)\n          })\n      }\n    )\n  }\n\n  componentDidMount = () => {\n    this.props.getProfileFetch()\n      .then(() => foxApi.getCompanySafetyInfo(this.props.company))\n      .then((data) => {\n        this.setState({ ...data })\n      })\n  }\n\n  render = () => {\n    return (\n      this.props.username ?\n        <CCard>\n          <CCardHeader>\n            <CCardTitle>\n              Safety info\n            </CCardTitle>\n          </CCardHeader>\n          <CCardBody>\n            <CRow>\n              <CCol >\n                <CButton\n                  shape=\"pill\"\n                  className='mr-3 mb-3'\n                  variant=\"outline\"\n                  color=\"info\"\n                  id={this.state.personal_declaration_template}\n                  name=\"personal_declaration_template\"\n                  value={this.state.personal_declaration_template}\n                  onClick={this.downloadFile}\n                >\n                  Personal Declaration\n      \t\t\t\t</CButton>\n                <CButton\n                  shape=\"pill\"\n                  className='mr-3 mb-3'\n                  variant=\"outline\"\n                  color=\"info\"\n                  id={this.state.safety_quiz_template}\n                  name=\"safety_quiz_template\"\n                  value={this.state.safety_quiz_template}\n                  onClick={this.downloadFile}\n                >\n                  Safety Quiz\n      \t\t\t\t</CButton>\n              </CCol>\n            </CRow>\n            <CRow alignHorizontal=\"center\">\n              <CCol md=\"9\">\n                <CEmbed\n                  ratio=\"16by9\"\n                >\n                  <iframe src={this.state.safety_video_url}\n                    frameBorder=\"0\"\n                    allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\"\n                    allowFullScreen>\n                  </iframe>\n                </CEmbed>\n              </CCol>\n            </CRow >\n          </CCardBody>\n        </CCard>\n        : <Redirect to=\"\" />\n\n    )\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    username: state.currentUser.username,\n    company: state.currentUser.company\n  }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  getProfileFetch: () => dispatch(getProfileFetch()),\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SafetyVideo)\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AAUA;AAEA;AACA;AAEA;;;;;;;;;;;;;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AALA;AACA;;AAOA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAFA;AAKA;AAEA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAvBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;AAyBA;AACA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;AAaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;AAcA;AAAA;AACA;AAAA;AAEA;AADA;AAGA;AACA;AACA;AACA;AAHA;AAUA;AAAA;AAGA;AACA;;;;;AArGA;AACA;AAsGA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AADA;AAAA;AACA;AAGA;;;;A","sourceRoot":""}