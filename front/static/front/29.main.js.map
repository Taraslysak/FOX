{"version":3,"file":"29.main.js","sources":["webpack:///./src/components/views/managers/ClientManagerEdit.js"],"sourcesContent":["import React, { Component } from 'react'\nimport { getProfileFetch, getContractorList, setProjectId } from '../../../actions'\nimport { connect } from 'react-redux'\nimport {\n  CForm,\n  CFormGroup,\n  CInput,\n  CLabel, CRow,\n  CCol,\n  CSelect,\n  CButton,\n  CCard,\n  CCardHeader,\n  CCardBody,\n  CCardTitle\n} from \"@coreui/react\";\nimport DjangoCSRFToken from 'django-react-csrftoken'\nimport { FoxApiService } from '../../../services'\n\nconst foxApi = new FoxApiService();\n\nconst positions = [\n  { id: -1, position: \"Choose manager position\" },\n  { id: \"SafeMan\", position: \"Safety Manager\" },\n  { id: \"SecMan\", position: \"Security Manager\" },\n  { id: \"SecOff\", position: \"Security Officer\" },\n  { id: \"SiteOwn\", position: \"Site Owner\" },\n  { id: \"WorkOwn\", position: \"Owner of Work\" },\n  { id: \"SecGrd\", position: \"Security Guards\" }\n]\n\n\nclass ClientManagerEdit extends Component {\n\n  state = {\n    username: \"\",\n    name: \"\",\n    email: \"\",\n    position: -1,\n    company: this.props.company,\n    role: \"CliMan\",\n    department: \"\",\n    error: false\n  }\n\n\n  handleChange = event => {\n    this.setState({\n      [event.target.name]: event.target.value\n    });\n  }\n\n  handleSubmit = async event => {\n    event.preventDefault();\n\n    if (parseInt(this.state.position) < 0) {\n      this.setState({\n        error: 'Manager Position was not selected! Please, choose position form the list'\n      })\n    } else {\n      this.formData = this.state;\n      delete this.formData.error;\n      await foxApi.updateEntityOf('client_managers', this.props.match.params.id, this.formData).then(() => {\n        this.props.history.goBack()\n      },\n        (error) => {\n          console.error(error);\n          this.setState({\n            error: 'Manager update failed!' +\n              ' Please check your input and try again!' +\n              ' In case this problem repeats, please contact your administrator!'\n          })\n        })\n    }\n  }\n\n  componentDidMount = async () => {\n    await this.props.getProfileFetch()\n      .then(() => foxApi.getDetailsOf('client_managers', this.props.match.params.id))\n      .then((data) => this.setState({ ...data }))\n  }\n\n  render = () => {\n\n    return (\n      <CRow>\n        <CCol>\n          <CCard>\n            <CCardHeader>\n              <CCardTitle>Mananger details</CCardTitle>\n            </CCardHeader>\n            <CCardBody>\n              <CForm\n                onSubmit={this.handleSubmit}\n              >\n                <DjangoCSRFToken />\n                <CFormGroup>\n                  <CLabel htmlFor=\"username\">Manager username</CLabel>\n                  <CInput\n                    id=\"username\"\n                    name='username'\n                    placeholder=\"Username\"\n                    value={this.state.username}\n                    onChange={this.handleChange}\n                    required />\n                </CFormGroup>\n                <CFormGroup>\n                  <CLabel htmlFor=\"name\">Manager verbose name</CLabel>\n                  <CInput\n                    id=\"name\"\n                    name='name'\n                    placeholder=\"Verbose name\"\n                    value={this.state.name}\n                    onChange={this.handleChange}\n                    required />\n                </CFormGroup>\n                <CFormGroup>\n                  <CLabel htmlFor=\"email\">Manager email</CLabel>\n                  <CInput\n                    id=\"email\"\n                    type=\"email\"\n                    name=\"email\"\n                    placeholder=\"Email\"\n                    value={this.state.email}\n                    onChange={this.handleChange}\n                    required\n                  />\n                </CFormGroup>\n                <CFormGroup>\n                  <CLabel htmlFor=\"target_type\">Manager Position</CLabel>\n                  <CSelect\n                    id=\"position\"\n                    name=\"position\"\n                    placeholder=\"Choose position\"\n                    value={this.state.position}\n                    onChange={this.handleChange}\n                    required\n                  >\n                    {positions.map((option) => {\n                      return (\n                        <option key={option.id} value={option.id}>{option.position}</option>\n                      )\n                    }\n                    )}\n                  </CSelect>\n                </CFormGroup>\n                <CFormGroup>\n                  <CLabel htmlFor=\"department\">Manager department</CLabel>\n                  <CInput\n                    id=\"department\"\n                    name=\"department\"\n                    placeholder=\"Department\"\n                    value={this.state.department}\n                    onChange={this.handleChange}\n                    required />\n                </CFormGroup>\n                <CFormGroup>\n                  <CButton shape=\"pill\" type=\"submit\" color=\"dark\" variant=\"outline\" block>Save changes</CButton>\n                </CFormGroup>\n                {this.state.error\n                  ? <p>{this.state.error}</p>\n                  : null\n                }\n              </CForm>\n            </CCardBody>\n          </CCard>\n\n        </CCol>\n      </CRow >\n    )\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    company: state.currentUser.company,\n  }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  getProfileFetch: () => dispatch(getProfileFetch()),\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ClientManagerEdit)\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAaA;AACA;AAEA;AAEA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAGA;;;;;;;;;;;;;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;AACA;AAWA;AACA;AAGA;AACA;;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AADA;AACA;AALA;AAAA;AACA;AADA;AAQA;AACA;AATA;AAAA;AAWA;AACA;AAEA;AACA;AAAA;AACA;AADA;AAKA;AACA;AArBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;AAuBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAKA;AAEA;AASA;AADA;AAKA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AANA;AASA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AANA;AASA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AAWA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AANA;AASA;AACA;AAAA;AAAA;AAEA;AAKA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AANA;AASA;AAAA;AAAA;AAAA;AAAA;AAAA;AAaA;AACA;;;;;AA3IA;AACA;AA4IA;AACA;AACA;AADA;AAGA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AADA;AAAA;AACA;AAGA;;;;A","sourceRoot":""}