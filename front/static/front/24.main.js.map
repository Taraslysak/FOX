{"version":3,"file":"24.main.js","sources":["webpack:///./src/components/views/managers/ClientManagerDetail.js"],"sourcesContent":["import React, { Component } from 'react'\r\nimport { getProfileFetch, getContractorList, setProjectId } from '../../../actions'\r\nimport { connect } from 'react-redux'\r\nimport {\r\n    CForm,\r\n    CFormGroup,\r\n    CInput,\r\n    CLabel, CRow,\r\n    CCol,\r\n    CSelect,\r\n    CButton,\r\n} from \"@coreui/react\";\r\nimport DjangoCSRFToken from 'django-react-csrftoken'\r\nimport { FoxApiService } from '../../../services'\r\n\r\nconst foxApi = new FoxApiService();\r\n\r\nconst positions = [\r\n    { id: -1, position: \"Choose manager position\" },\r\n    { id: \"SafeMan\", position: \"Safety Manager\" },\r\n    { id: \"SecMan\", position: \"Security Manager\" },\r\n    { id: \"SecOff\", position: \"Security Officer\" },\r\n    { id: \"SiteOwn\", position: \"Site Owner\" },\r\n    { id: \"WorkOwn\", position: \"Owner of Work\" },\r\n    { id: \"SecGrd\", position: \"Security Guards\" }\r\n]\r\n\r\n\r\nclass ClientManagerDetail extends Component {\r\n\r\n    state = {\r\n        username: \"\",\r\n        email: \"\",\r\n        position: -1,\r\n        company: this.props.company,\r\n        role: \"CliMan\",\r\n        error: false\r\n    }\r\n\r\n\r\n    handleChange = event => {\r\n        this.setState({\r\n            [event.target.name]: event.target.value\r\n        });\r\n    }\r\n\r\n    handleSubmit = async event => {\r\n        event.preventDefault();\r\n\r\n        if (parseInt(this.state.position) < 0) {\r\n            this.setState({\r\n                error: 'Manager Position was not selected! Please, choose position form the list'\r\n            })\r\n        } else {\r\n            this.formData = this.state;\r\n            delete this.formData.error;\r\n            await foxApi.updateEntityOf('client_managers', this.props.match.params.id, this.formData).then(() => {\r\n                this.props.history.goBack()\r\n            },\r\n                (error) => {\r\n                    console.error(error);\r\n                    this.setState({\r\n                        error: 'Manager update failed!' +\r\n                            ' Please check your input and try again!' +\r\n                            ' In case this problem repeats, please contact your administrator!'\r\n                    })\r\n                })\r\n        }\r\n    }\r\n\r\n    componentDidMount = async () => {\r\n        await this.props.getProfileFetch()\r\n            .then(() => foxApi.getDetailsOf('client_managers', this.props.match.params.id))\r\n            .then((data) => this.setState({ ...data }))\r\n    }\r\n\r\n    render = () => {\r\n\r\n        return (\r\n            <CRow>\r\n                <CCol>\r\n                    <CForm\r\n                        onSubmit={this.handleSubmit}\r\n                    >\r\n                        <DjangoCSRFToken />\r\n                        <CFormGroup>\r\n                            <CLabel htmlFor=\"username\">Enter client manager username</CLabel>\r\n                            <CInput\r\n                                id=\"username\"\r\n                                name='username'\r\n                                placeholder=\"Username\"\r\n                                value={this.state.username}\r\n                                onChange={this.handleChange}\r\n                                required />\r\n                        </CFormGroup>\r\n                        <CFormGroup>\r\n                            <CLabel htmlFor=\"email\">Enter client manager email</CLabel>\r\n                            <CInput\r\n                                id=\"email\"\r\n                                type=\"email\"\r\n                                name=\"email\"\r\n                                placeholder=\"Email\"\r\n                                value={this.state.email}\r\n                                onChange={this.handleChange}\r\n                                required\r\n                            />\r\n                        </CFormGroup>\r\n                        <CFormGroup>\r\n                            <CLabel htmlFor=\"target_type\">Client Manager Position</CLabel>\r\n                            <CSelect\r\n                                id=\"position\"\r\n                                name=\"position\"\r\n                                placeholder=\"Choose position\"\r\n                                value={this.state.position}\r\n                                onChange={this.handleChange}\r\n                                required\r\n                            >\r\n                                {positions.map((option) => {\r\n                                    return (\r\n                                        <option key={option.id} value={option.id}>{option.position}</option>\r\n                                    )\r\n                                }\r\n                                )}\r\n                            </CSelect>\r\n                        </CFormGroup>\r\n                        <CFormGroup>\r\n                            <CButton type=\"submit\" color=\"dark\" variant=\"outline\" block>Create client manager</CButton>\r\n                        </CFormGroup>\r\n                        {this.state.error\r\n                            ? <p>{this.state.error}</p>\r\n                            : null\r\n                        }\r\n                    </CForm>\r\n                </CCol>\r\n            </CRow >\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        company: state.currentUser.company,\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n    getProfileFetch: () => dispatch(getProfileFetch()),\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ClientManagerDetail)\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AASA;AACA;AAEA;AAEA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAGA;;;;;;;;;;;;;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AACA;AASA;AACA;AAGA;AACA;;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AADA;AACA;AALA;AAAA;AACA;AADA;AAQA;AACA;AATA;AAAA;AAWA;AACA;AAEA;AACA;AAAA;AACA;AADA;AAKA;AACA;AArBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;AAuBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAKA;AAEA;AAIA;AADA;AAKA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AANA;AASA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AAWA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AANA;AASA;AACA;AAAA;AAAA;AAEA;AAKA;AAAA;AAAA;AAAA;AAAA;AAUA;AACA;;;;;AA7GA;AACA;AA8GA;AACA;AACA;AADA;AAGA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AADA;AAAA;AACA;AAGA;;;;A","sourceRoot":""}