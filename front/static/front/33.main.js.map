{"version":3,"file":"33.main.js","sources":["webpack:///./src/components/views/safety/SafetyPresets.js"],"sourcesContent":["import React, { Component } from 'react';\nimport { Redirect, withRouter } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport {\n  CForm,\n  CFormGroup,\n  CInput,\n  CLabel,\n  CRow,\n  CCol,\n  CButton,\n  CInputFile,\n  CLink\n} from \"@coreui/react\";\nimport DjangoCSRFToken from 'django-react-csrftoken';\nimport { FoxApiService } from '../../../services';\nimport { getProfileFetch, } from '../../../actions';\n\n\nconst foxApi = new FoxApiService();\n\nclass SafetyPresets extends Component {\n\n  state = {\n    personal_declaration_template: \"\",\n    safety_quiz_template: \"\",\n    safety_video_url: \"\",\n    error: false\n  }\n\n  handleChange = event => {\n    this.setState({\n      [event.target.name]: event.target.value\n    });\n  }\n  handleFileUpload = event => {\n    this.setState({\n      [event.target.name]: event.target.files[0]\n    });\n  }\n\n  handleSubmit = async event => {\n    event.preventDefault();\n    this.requestData = this.state;\n    delete this.requestData.error;\n    this.formData = new FormData\n    Object.entries(this.requestData).forEach(([key, value]) => {\n      this.formData.append(key, value);\n    })\n    await foxApi.patchCompanySafetyInfo(this.props.company, this.formData)\n      .then(() => {\n        this.props.history.push(`/safety/video`)\n      },\n        (error) => {\n          console.error(error);\n          this.setState({\n            error: 'Safety info upload failed!' +\n              ' Please check your input and try again!' +\n              ' In case this problem repeats, please contact your administrator!'\n          })\n        })\n  }\n\n  componentDidMount = async () => {\n    await this.props.getProfileFetch()\n  }\n\n  render = () => {\n    return (\n      this.props.role === \"CliAdm\" ? <CRow>\n        <CCol>\n          <CForm\n            onSubmit={this.handleSubmit}\n          >\n            <DjangoCSRFToken />\n            <CFormGroup>\n              <CLabel htmlFor=\"safety_video_url\">Url to document</CLabel>\n              <CInput\n                type=\"url\"\n                id=\"safety_video_url\"\n                name=\"safety_video_url\"\n                placeholder=\"https://example.com\"\n                pattern=\"https://.*\"\n                value={this.state.safety_video_url}\n                onChange={this.handleChange}\n                required />\n            </CFormGroup>\n            <CFormGroup>\n              <CLabel htmlFor=\"safety_quiz_template\">Safety Quiz Template</CLabel>\n              <CInputFile id=\"safety_quiz_template\" name=\"safety_quiz_template\" onChange={this.handleFileUpload}\n                required />\n            </CFormGroup>\n            <CFormGroup>\n              <CLabel htmlFor=\"personal_declaration_template\">Personal Declaration Template:</CLabel>\n              <CInputFile id=\"personal_declaration_template\" name=\"personal_declaration_template\" onChange={this.handleFileUpload}\n                required />\n            </CFormGroup>\n            <CFormGroup>\n              <CButton type=\"submit\" color=\"dark\" variant=\"outline\" block>Submit safety info</CButton>\n            </CFormGroup>\n            {this.state.error\n              ? <p>{this.state.error}</p>\n              : null\n            }\n          </CForm>\n          <CLink to=\"/safety/video\">Inspect preview</CLink>\n        </CCol>\n      </CRow >\n        :\n        <Redirect to=\"/safety/video\" />\n    )\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    role: state.currentUser.role,\n    company: state.currentUser.company\n  }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  getProfileFetch: () => dispatch(getProfileFetch()),\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(withRouter(SafetyPresets))\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAWA;AACA;AACA;AAGA;AACA;AACA;;;;;;;;;;;;;;;;AAEA;AACA;AACA;AACA;AACA;AAJA;AACA;AAMA;AACA;AAGA;AACA;AAAA;AACA;AAGA;AACA;;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAPA;AAAA;AAUA;AACA;AAEA;AACA;AAAA;AACA;AADA;AAKA;AACA;AApBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;AAqBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AAIA;AADA;AAKA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;AAWA;AAAA;AACA;AAAA;AAAA;AACA;AADA;AAIA;AAAA;AACA;AAAA;AAAA;AACA;AADA;AAIA;AAAA;AAAA;AAAA;AAAA;AAOA;AAAA;AAIA;AAAA;AAEA;AACA;;;;;AA3FA;AACA;AA4FA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AADA;AAAA;AACA;AAGA;;;;A","sourceRoot":""}