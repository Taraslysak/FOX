{"version":3,"file":"17.main.js","sources":["webpack:///./src/components/views/workers/WorkerCreate.js","webpack:///./src/components/views/workers/optionLists.js"],"sourcesContent":["import React, { Component } from 'react'\nimport DjangoCSRFToken from 'django-react-csrftoken'\nimport { connect } from 'react-redux'\nimport {\n  CForm,\n  CFormGroup,\n  CInput,\n  CLabel,\n  CRow,\n  CCol,\n  CButton,\n  CInputFile,\n  CCard,\n  CCardTitle,\n  CCardBody,\n  CCardHeader,\n  CCardSubtitle\n} from \"@coreui/react\";\nimport { getProfileFetch } from '../../../actions'\nimport { FoxApiService } from '../../../services'\nimport { FoxFormGroupWithUpload, FoxSelectFormGroup, FoxReactSelectFormGroup } from '../../forms'\nimport { positions, tradeCompetencies } from './optionLists'\n\nconst foxApi = new FoxApiService();\n\nclass WorkerCreate extends Component {\n\n  state = {\n    name: \"\",\n    contractor: this.props.contractor,\n    birthday: \"\",\n    phone_number: \"\",\n    card_number_id: \"\",\n    license_number: \"\",\n    license_scan: \"\",\n    passport: \"\",\n    passport_scan: \"\",\n    safety_green_card: \"\",\n    safety_green_card_scan: \"\",\n    position_in_company: -1,\n    safety_quiz_answer: \"\",\n    personal_declaration: \"\",\n    submitCallback: \"\",\n    registration_number: \"\",\n    trade_competency: -1,\n    error: false\n  }\n\n  handleChange = event => {\n    this.setState({\n      [event.target.name]: event.target.value\n    });\n  }\n\n  handleReactSelect = (option, event) => {\n    this.setState({\n      [event.name]: option.value\n    })\n  }\n\n  handleFileUpload = event => {\n    this.setState({\n      [event.target.name]: event.target.files[0]\n    });\n  }\n\n  handleSubmit = async event => {\n    event.preventDefault();\n    console.log(\"you are here\");\n    if (this.state.position_in_company === -1) {\n      this.setState({\n        error: 'Worker position in company was not selected! Please, choose position form the list'\n      })\n    }\n    else if (this.state.trade_competency === -1) {\n      this.setState({\n        error: 'Trade competency was not selected! Please, choose competency form the list'\n      })\n    }\n    else {\n      this.requestData = this.state;\n      delete this.requestData.error;\n      this.formData = new FormData\n      Object.entries(this.requestData).forEach(([key, value]) => {\n        this.formData.append(key, value);\n      })\n      await foxApi.createEntityWithFile('workers', this.formData)\n        .then((data) => {\n          this.state.submitCallback(data.id)\n        },\n          (error) => {\n            console.error(error);\n            this.setState({\n              error: 'Worker creation failed!' +\n                ' Please check your input and try again!' +\n                ' In case this problem repeats, please contact your administrator!'\n            })\n          })\n    }\n  }\n\n  handleSimpleSubmit = (event) => {\n    this.setState({\n      submitCallback: (id) => { return this.props.history.goBack() }\n    });\n  }\n\n  handleSubmitWithCompetencies = event => {\n    this.setState({\n      submitCallback: (id) => { this.props.history.push(`/workers/${id}/competencies/new`) }\n    });\n  }\n\n  componentDidMount = async () => {\n    await this.props.getProfileFetch()\n  }\n\n  render = () => {\n    const preventDefaultSubmit = e => {\n      e.preventDefault();\n    }\n    return (\n      <CRow>\n        <CCol>\n          <CCard>\n            <CCardHeader>\n              <CCardTitle>\n                New Worker\n              </CCardTitle>\n              <CCardSubtitle>\n                Fill up the form below to add a new Worker\n              </CCardSubtitle>\n            </CCardHeader>\n            <CCardBody>\n              <CForm\n                onSubmit={this.handleSubmit}\n              >\n                <DjangoCSRFToken />\n                <CFormGroup>\n                  <CInput\n                    id=\"name\"\n                    name='name'\n                    placeholder=\"Name\"\n                    value={this.state.name}\n                    onChange={this.handleChange}\n                    required />\n                </CFormGroup>\n                <CFormGroup>\n                  <CLabel htmlFor=\"birthday\">Birthday</CLabel>\n                  <CInput\n                    type=\"date\"\n                    id=\"birthday\"\n                    name=\"birthday\"\n                    value={this.state.birthday}\n                    onChange={this.handleChange}\n                    required\n                  />\n                </CFormGroup>\n                <CFormGroup>\n                  <CInput\n                    id=\"phone_number\"\n                    name=\"phone_number\"\n                    placeholder=\"Phone number\"\n                    value={this.state.phone_number}\n                    onChange={this.handleChange}\n                  />\n                </CFormGroup>\n                <FoxReactSelectFormGroup\n                  options={positions}\n                  inputInfo=\"position_in_company\"\n                  inputValue={this.state.position_in_company}\n                  handleChange={this.handleReactSelect}\n                />\n                <FoxSelectFormGroup\n                  options={tradeCompetencies}\n                  inputInfo=\"trade_competency\"\n                  inputValue={this.state.trade_competency}\n                  handleChange={this.handleChange}\n                />\n                <CFormGroup>\n                  <CInput\n                    id=\"card_number_id\"\n                    name='card_number_id'\n                    placeholder=\"Card number ID\"\n                    value={this.state.card_number_id}\n                    onChange={this.handleChange}\n                    required />\n                </CFormGroup>\n                <FoxFormGroupWithUpload\n                  inputValue={this.state.license_number}\n                  handleChange={this.handleChange}\n                  handleFileUpload={this.handleFileUpload}\n                  inputInfo=\"license_number\"\n                  uploadInfo=\"license_scan\"\n                />\n                <FoxFormGroupWithUpload\n                  inputValue={this.state.passport}\n                  handleChange={this.handleChange}\n                  handleFileUpload={this.handleFileUpload}\n                  inputInfo=\"passport\"\n                  uploadInfo=\"passport_scan\"\n                />\n                <FoxFormGroupWithUpload\n                  inputValue={this.state.safety_green_card}\n                  handleChange={this.handleChange}\n                  handleFileUpload={this.handleFileUpload}\n                  inputInfo=\"safety_green_card\"\n                  uploadInfo=\"safety_green_card_scan\"\n                />\n                <CFormGroup>\n                  <CInput\n                    id=\"registration_number\"\n                    name='registration_number'\n                    placeholder=\"Registration number\"\n                    value={this.state.registration_number}\n                    onChange={this.handleChange}\n                    required />\n                </CFormGroup>\n                <CFormGroup>\n                  <CLabel htmlFor=\"safety_quiz_answer\">Safety quiz answer</CLabel>\n                  <CInputFile id=\"safety_quiz_answer\" name=\"safety_quiz_answer\" onChange={this.handleFileUpload}\n                    required />\n                </CFormGroup>\n                <CFormGroup>\n                  <CLabel htmlFor=\"personal_declaration\">Personal declaration</CLabel>\n                  <CInputFile id=\"personal_declaration\" name=\"personal_declaration\" onChange={this.handleFileUpload}\n                    required />\n                </CFormGroup>\n                <CFormGroup>\n                  <CRow>\n                    <CCol md=\"6\">\n                      <CButton\n                        onClick={this.handleSimpleSubmit}\n                        shape=\"pill\"\n                        type=\"submit\"\n                        color=\"dark\"\n                        variant=\"outline\"\n                        block>Create Worker</CButton>\n                    </CCol>\n                    <CCol md=\"6\">\n                      <CButton\n                        onClick={this.handleSubmitWithCompetencies}\n                        shape=\"pill\"\n\n                        type=\"submit\"\n                        color=\"primary\"\n                        variant=\"outline\"\n                        block>Create Worker and add special competencies</CButton>\n                    </CCol>\n                  </CRow>\n                </CFormGroup>\n                {this.state.error\n                  ? <p>{this.state.error}</p>\n                  : null\n                }\n              </CForm>\n            </CCardBody>\n          </CCard>\n        </CCol>\n      </CRow >\n    )\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    contractor: state.currentUser.id,\n  }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  getProfileFetch: () => dispatch(getProfileFetch()),\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(WorkerCreate)\n\n","const positions = [\n    { value: -1, label: \"Choose worker position\" },\n    { value: \"Weld\", label: \"Welder\" },\n    { value: \"Fit\", label: \"Fitter\" },\n    { value: \"Help\", label: \"Helper\" },\n    { value: \"Rig\", label: \"Rigger\" },\n    { value: \"SafeOff\", label: \"Safety Officer\" },\n    { value: \"Plumb\", label: \"Plumber\" },\n    { value: \"Tech\", label: \"Technician\" },\n    { value: \"Electr\", label: \"Electrician\" },\n    { value: \"FlrInst\", label: \"Flooring Installer\" },\n    { value: \"HVACInst\", label: \"HVAC Installer\" },\n    { value: \"InsInst\", label: \"Insulation Installer\" },\n    { value: \"Surv\", label: \"Surveyor\" },\n    { value: \"BrcMans\", label: \"Brick Manson\" },\n    { value: \"Roof\", label: \"Roofer\" },\n    { value: \"SiteSuper\", label: \"Site Supervisor\" },\n    { value: \"Other\", label: \"Other\" }\n]\n\nconst tradeCompetencies = [\n    { id: -1, position: \"Choose trade competency\" },\n    { id: \"Civ\", position: \"Civil\" },\n    { id: \"Electr\", position: \"Electrical\" },\n    { id: \"Mech\", position: \"Mechanical\" },\n    { id: \"Infra\", position: \"Infra\" },\n    { id: \"Gen\", position: \"General\" },\n    { id: \"Safe\", position: \"Safety\" },\n    { id: \"Secur\", position: \"Security\" },\n]\n\n\nexport { positions, tradeCompetencies }"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAeA;AACA;AACA;AACA;AAEA;AACA;AACA;;;;;;;;;;;;;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlBA;AACA;AAoBA;AACA;AAGA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AAGA;AACA;;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAHA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AADA;AACA;AALA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AACA;AAQA;AACA;AADA;AACA;AAVA;AAAA;AACA;AADA;AAcA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAnBA;AAAA;AAsBA;AACA;AAEA;AACA;AAAA;AACA;AADA;AAKA;AACA;AAhCA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;AAkCA;AACA;AACA;AAAA;AAAA;AADA;AAGA;AACA;AACA;AACA;AACA;AAAA;AAAA;AADA;AAGA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AACA;AACA;AACA;AAAA;AAcA;AADA;AAMA;AACA;AACA;AACA;AACA;AACA;AANA;AASA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AANA;AAWA;AACA;AACA;AACA;AACA;AALA;AASA;AACA;AACA;AACA;AAJA;AAOA;AACA;AACA;AACA;AAJA;AAQA;AACA;AACA;AACA;AACA;AACA;AANA;AASA;AACA;AACA;AACA;AACA;AALA;AAQA;AACA;AACA;AACA;AACA;AALA;AAQA;AACA;AACA;AACA;AACA;AALA;AASA;AACA;AACA;AACA;AACA;AACA;AANA;AASA;AAAA;AACA;AAAA;AAAA;AACA;AADA;AAIA;AAAA;AACA;AAAA;AAAA;AACA;AADA;AAKA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AANA;AAQA;AAAA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAPA;AAqBA;AACA;;;;;AA7OA;AACA;AA8OA;AACA;AACA;AADA;AAGA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AADA;AAAA;AACA;AAGA;;;;;;;;;;;;AClRA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAGA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;;;;;A","sourceRoot":""}